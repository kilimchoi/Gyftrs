<!DOCTYPE html>
<html> 
  <head>
		<script src="//d7xe6yl2ckrgs.cloudfront.net/js/2/importio.js"></script>
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
		<script>/* ===============================
| TABLESORT.JS
| Copyright, Andy Croxall (mitya@mitya.co.uk)
| For documentation and demo see http://mitya.co.uk/scripts/Animated-table-sort-REGEXP-friendly-111
|
| USAGE
| This script may be used, distributed and modified freely but this header must remain in tact.
| For usage info and demo, including info on args and params, see www.mitya.co.uk/scripts
=============================== */


jQuery.fn.sortTable = function(params) {


	/*-----------
	| STOP right now if anim already in progress
	-----------*/

	if ($(this).find(':animated').length > 0) return;
	
	/*-----------
	| VALIDATE TABLE & PARAMS
	|	- if no col to sort on passed, complain and return
	|	- if table doesn't contain requested col, complain and return
	| If !sortType or invalid sortType, assume ascii sort
	-----------*/
	
	var error = null;
	var complain = null;
	if (!params.onCol) { error = "No column specified to search on"; complain = true; }
	else if ($(this).find('td:nth-child('+params.onCol+')').length == 0) { error = "The requested column wasn't found in the table"; complain = true; }
	if (error) { if (complain) alert(error); return; }
	if (!params.sortType || params.sortType != 'numeric') params.sortType = 'ascii';


	/*-----------
	| PREP
	| 	- declare array to store the contents of each <td>, or, if sorting on regexp, the pattern match of the regexp in each <td>
	| 	- Give the <table> position: relative to aid animation
	| 	- Mark the col we're sorting on with an identifier class
	-----------*/
	
	var valuesToSort = [];
	$(this).css('position', 'relative');
	var doneAnimating = 0;
	var tdSelectorText = 'td'+(!params.onCol ? '' : ':nth-child('+params.onCol+')');
	$(this).find('td:nth-child('+params.onCol+')').addClass('sortOnThisCol');
	var thiss = this;


	/*-----------
	| Iterate over table and. For each:
	| 	- append its content / regexp match (see above) to valuesToSort[]
	| 	- create a new <div>, give it position: absolute and copy over the <td>'s content into it
	| 	- fix the <td>'s width/height to its offset width/height so that, when we remove its html, it won't change shape
	|	- clear the <td>'s content
	| 	- clear the <td>'s content
	| There is no visual effect in this. But it means each <td>'s content is now 'animatable', since it's position: absolute.
	-----------*/	
	
	var counter = 0;
	$(this).find('td').each(function() {
		if ($(this).is('.sortOnThisCol') || (!params.onCol && !params.keepRelationships)) {
			var valForSort = !params.child ? $(this).text() : (params.child != 'input' ? $(this).find(params.child).text() : $(this).find(params.child).val());
			if (params.regexp) {
				valForSort = valForSort.match(new RegExp(params.regexp))[!params.regexpIndex ? 0 : params.regexpIndex];
			}
			valuesToSort.push(valForSort);
		}
		var thisTDHTMLHolder = document.createElement('div');
		with($(thisTDHTMLHolder)) {
			html($(this).html());
			if (params.child && params.child == 'input') html(html().replace(/<input /, "<input value='"+$(this).find(params.child).val()+"'", html()));
			css({position: 'relative', left: 0, top: 0});
		}
		$(this).html('');
		$(this).append(thisTDHTMLHolder);
		counter++;
	});
	
	
	/*-----------
	| Sort values array.
	|	- Sort (either simply, on ascii, or numeric if sortNumeric == true)
	|	- If descending == true, reverse after sort
	-----------*/

	params.sortType == 'numeric' ? valuesToSort.sort(function(a, b) { return (a.replace(/[^\d\.]/g, '', a)-b.replace(/[^\d\.]/g, '', b)); }) : valuesToSort.sort();
	if (params.sortDesc) {
		valuesToSort_tempCopy = [];
		for(var u=valuesToSort.length; u--; u>=0) valuesToSort_tempCopy.push(valuesToSort[u]);
		valuesToSort = valuesToSort_tempCopy;
		delete(valuesToSort_tempCopy)
	}
	

	
	/*-----------
	| Now, for each:
	-----------*/
	
	for(var k in valuesToSort) {
		
		//establish current <td> relating to this value of the array
		var currTD = $($(this).find(tdSelectorText).filter(function() {
			return (
				(
					!params.regexp
					&&
					(
						(
							params.child
							&&
							(
								(
									params.child != 'input'
									&&
									valuesToSort[k] == $(this).find(params.child).text()
								)
								||
								params.child == 'input'
								&&
								valuesToSort[k] == $(this).find(params.child).val()
							)
						)
						||
						(
							!params.child
							&&
							valuesToSort[k] == $(this).children('div').html()
						)
					)
				)
				||
				(
					params.regexp
					&&
					$(this).children('div').html().match(new RegExp(params.regexp))[!params.regexpIndex ? 0 : params.regexpIndex] == valuesToSort[k]
				)
			)
			&&
			!$(this).hasClass('tableSort_TDRepopulated');
		}).get(0));
		
		//give current <td> a class to mark it as having been used, so we don't get confused with duplicate values
		currTD.addClass('tableSort_TDRepopulated');
		
		//establish target <td> for this value and store as a node reference on this <td>
		var targetTD = $($(this).find(tdSelectorText).get(k));
		currTD.get(0).toTD = targetTD;
		
		//if we're sorting on a particular column and maintaining relationships, also give the other <td>s in rows a node reference
		//denoting ITS target, so they move with their lead siibling
		if (params.keepRelationships) {
			var counter = 0;
			$(currTD).parent().children('td').each(function() {
				$(this).get(0).toTD = $(targetTD.parent().children().get(counter));
				counter++;
			});
		}
		
		//establish current relative positions for the current and target <td>s and use this to calculate how far each <div> needs to move
		var currPos = currTD.position();
		var targetPos = targetTD.position();
		var moveBy_top = targetPos.top - currPos.top;
		
		//invert values if going backwards/upwards
		if (targetPos.top > currPos.top) moveBy_top = Math.abs(moveBy_top);
		
		/*-----------
		| ANIMATE
		| 	- work out what to animate on.
		| 		- if !keepRelationships, animate only <td>s in the col we're sorting on (identified by .sortOnThisCol)
		| 		- if keepRelationships, animate all cols but <td>s that aren't .sortOnThisCol follow lead sibiling with .sortOnThisCol
		| 	- run animation. On callback, update each <td> with content of <div> that just moved into it and remove <div>s
		|	- If noAnim, we'll still run aniamte() but give it a low duration so it appears instant
		-----------*/		
		
		var animateOn = params.keepRelationships ? currTD.add(currTD.siblings()) : currTD;
		var done = 0;
		animateOn.children('div').animate({top: moveBy_top}, !params.noAnim ? 500 : 0, null, function() {
			if ($(this).parent().is('.sortOnThisCol') || !params.keepRelationships) {
				done++;
				if (done == valuesToSort.length-1) thiss.tableSort_cleanUp();
			}
		});
		
	}
		
};


jQuery.fn.tableSort_cleanUp = function() {

	/*-----------
	| AFTER ANIM
	| 	- assign each <td> its new content as property of it (DON'T populate it yet - this <td> may still need to be read by
	|	  other <td>s' toTD node references
	|	- once new contents for each <td> gathered, populate
	|	- remove some identifier classes and properties
	-----------*/
	$(this).find('td').each(function() {
		if($(this).get(0).toTD) $($(this).get(0).toTD).get(0).newHTML = $(this).children('div').html();
	});
	$(this).find('td').each(function() { $(this).html($(this).get(0).newHTML); });
	$('td.tableSort_TDRepopulated').removeClass('tableSort_TDRepopulated');
	$(this).find('.sortOnThisCol').removeClass('sortOnThisCol');
	$(this).find('td[newHTML]').attr('newHTML', '');
	$(this).find('td[toTD]').attr('toTD', '');
	
};</script>
		<script>
		importio.init({"auth": {
		    "userGuid": "c4148a01-6fe5-48a2-996f-adce08b49a4f",
		    "apiKey": "5hXx5nTME6kvxBSsUxRELMXgCc/IPupD0Nd1hbo2lqvLXEaDkXGbpcfJBLkARwz47fNa1AS924qBgTj22n4oxQ=="
		}});
 
		$(document).ready(function() {
        	    var artistObjects;
        	    var firstProductCode;
        	    var secondProductCode;
        	    var thirdProductCode;
                    $('#search_button').click(function() {
                    	var artist_name1 = $('#artist_name1').val();
                    	var artist_name2 = $('#artist_name2').val();
                    	var artist_name3 = $('#artist_name3').val();
                    	for (var i = 0; i < 3; i++) {
                    		var searchquery;
                    		if (i == 0) {
                    			searchquery = artist_name1;
                    		} 
                    		if (i == 1) {
                    			searchquery = artist_name2;
                    		}
                    		if (i == 2) {
                    			searchquery = artist_name3;
                    		}
	                    	var query_object = {"requestId":"testquery","input":{"artist_name": searchquery},"connectorGuids":["103c2bfd-8696-4ecc-a940-a326e3c39e35"]};
	                    	
	                    importio.query(
	                        query_object,
	                        function(data) {
				                var jsonData = data;
				                var productCodeArr = new Array();
				                console.log(jsonData);
				                for(var i = 0; i < jsonData.length; i++) {
				                  var url = data[i].data.url.split("/");
				                  productCodeArr[i] = url[5];
				                  if (i == 0) {
				            		firstProductCode = productCodeArr[0];
				            		 console.log("first product code is", firstProductCode);
					              }
					              if (i == 1) {
					            	secondProductCode = productCodeArr[0];
					            	console.log("second product code is", secondProductCode);
					              }
					              if (i == 2) {
					            	thirdProductCode = productCodeArr[0];
					            	 console.log("third product code is", thirdProductCode);
					              }
					            }
				
							     var query_object2 = {"requestId":"testquery","input":{"id_2":firstProductCode,"id_1":secondProductCode,"id_3":thirdProductCode},"connectorGuids":["51d10173-4da5-4fb7-9014-9fe1d2fcb16a"]};
				                importio.query(
				                  query_object2,
				                  function(data) {
				                    console.log("second query data is: ", data);
				                    for (i = 0; i < data.length; i++) {
				                    	console.log("second query data is: ", data[i].data);
				                    	var image = data[i].data.image; 
				                    	$('#imageDiv').append('<tr><td style="width=100px">' + data[i].data.title + '</td>' + '<td>' + "<img src= " + image + " style=' float:right' >" + '</td>' + '<td>' + data[i].data.price + '</td></tr>');
				                    	$('#imageDiv').append("<br />");

				                    }
				                })
				            }
	          	        );
	                }
	            })
	        });


 
	</script> 
	</head> 
	<body>
		<form> 
			<input type="text" id="artist_name1"/>
			<input type="text" id="artist_name2" />
			<input type="text" id="artist_name3" />
			<button id="search_button" type="button">Search</button>
 			<div id="imageDiv"></div>
		</form>
	</body>
</html>
